<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etapa 4: Documentando a API com Scalar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-size: 1.1rem; }
        pre {
            background-color: #282c34;
            color: #abb2bf;
            border: 1px solid #dee2e6;
            border-radius: 0.35rem;
            padding: 1rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .comando {
            background-color: #e9ecef;
            color: #212529;
            font-family: monospace;
            padding: 0.2rem 0.4rem;
            border-radius: 0.2rem;
        }
        .destaque-arquivo {
            font-weight: bold;
            color: #0d6efd;
        }
        h2, h3 {
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="container mt-5 mb-5">
        <h1>Etapa 4: Documentando e Testando a API com Scalar</h1>
        <p class="lead">Após alguns desafios com a configuração padrão, optamos por uma alternativa moderna e elegante para documentação de APIs: o <strong>Scalar</strong>. Nesta etapa, veremos como instalar e configurar essa excelente ferramenta.</p>

        <h2>O que é Scalar?</h2>
        <p>Scalar é uma ferramenta de documentação de API que, assim como o Swagger UI, lê uma especificação OpenAPI (o arquivo `openapi.json`) e gera uma interface de usuário bonita e interativa. Muitos desenvolvedores a preferem por seu design limpo e ótima experiência de uso, especialmente na hora de testar os endpoints.</p>
        
        <h2>Passo 1: Instalando o Pacote</h2>
        <p>O primeiro passo é adicionar o pacote do Scalar ao nosso projeto. O comando é simples:</p>
        <pre><code class="language-bash">dotnet add package Scalar.AspNetCore</code></pre>
        <p>Isso adiciona a referência necessária ao nosso arquivo <span class="destaque-arquivo">.csproj</span>.</p>

        <h2>Passo 2: Configurando o Middleware</h2>
        <p>Com o pacote instalado, precisamos dizer para a nossa API usar o Scalar. Fazemos isso no arquivo <span class="destaque-arquivo">Program.cs</span>, adicionando uma única linha de código.</p>
        <p>Primeiro, garantimos que o `using` para o pacote exista no topo do arquivo:</p>
        <pre><code class="language-csharp">// Local: ClientesAPI/Program.cs
using Scalar.AspNetCore;</code></pre>
        <p>Depois, dentro do bloco <span class="comando">if (app.Environment.IsDevelopment())</span>, adicionamos a chamada para o middleware do Scalar:</p>
        <pre><code class="language-csharp">// Local: ClientesAPI/Program.cs

// ...
var app = builder.Build();

// Configure the HTTP request pipeline.
if (app.Environment.IsDevelopment())
{
    app.MapOpenApi(); // Essencial: Gera o openapi.json que o Scalar usa
    app.MapScalarApiReference(); // Adiciona a UI do Scalar
}
// ...
</code></pre>
        <div class="alert alert-success"><strong>Importante:</strong> A linha <span class="comando">app.MapOpenApi()</span> continua sendo essencial. Ela é responsável por gerar o arquivo `openapi.json` que o Scalar (e qualquer outra ferramenta similar) usa como fonte de dados para construir a documentação.</div>

        <h2>Passo 3: Acessando e Usando o Scalar</h2>
        <p>Agora vem a parte fácil. Execute sua aplicação:</p>
        <pre><code class="language-bash">dotnet run --project ClientesAPI</code></pre>
        <p>Com a aplicação rodando, abra seu navegador e navegue para a rota <span class="comando">/scalar</span>.</p>
        <p><strong>Exemplo:</strong> <a href="http://localhost:5185/scalar" target="_blank">http://localhost:5185/scalar</a> ou <a href="https://localhost:7084/scalar" target="_blank">https://localhost:7084/scalar</a></p>
        <p>Você verá a interface do Scalar, com um layout de três colunas:</p>
        <ul>
            <li><strong>À esquerda:</strong> Uma lista de todos os seus endpoints (GET, POST, etc.).</li>
            <li><strong>No centro:</strong> Os detalhes do endpoint selecionado, incluindo parâmetros e exemplos de código.</li>
            <li><strong>À direita:</strong> Um cliente de API integrado, onde você pode preencher dados e clicar em <strong>"Send Request"</strong> para testar a API ao vivo.</li>
        </ul>
        <p>A experiência é muito fluida e é uma excelente forma de documentar e validar o comportamento da sua API.</p>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>